# 带参数双因子收益挖掘评估报告

## 1. 现有搜索策略
- 组合来源：用户指定组合优先，其余由非参数前 6 因子的两两组合自动生成，数量上限 `max_factor_pairs`（默认 20）。
- 区间生成：仅用户指定的组合使用自定义区间；其他组合使用等分位自动分箱（默认 3 档）。分档后做笛卡尔积，选取年化收益率最高的单元格作为“最佳区间”。
- 稳健性约束：单元格样本量低于 `param_min_samples`（默认 300）且非强制保留时跳过；收益年化按日均 * 252 计算。

## 2. 能覆盖的收益空间
- 手动组合可精确评估用户给出的区间，确保该区间的收益被保留并高亮。
- 自动组合通过分位数切分，能捕捉大尺度的协同收益，但分档数少时搜索空间较粗，属于“粗网格”查找。

## 3. 潜在遗漏/约束
- 分档粒度限制：默认 3 档意味着每个因子只有 3 个候选区间，双因子仅 9 个交叉格子，可能错过更窄或偏尾部的高收益区间。
- 样本量阈值：`param_min_samples` 固定为 300，可能过滤掉高收益但样本不足的细分组合；但降低阈值会引入高噪声。
- 分位切分的漂移风险：不同因子分布差异大时，等分位可能把关键阈值切断（如市值在极端长尾），导致最佳区间与业务分层不一致。
- 无自适应细化：当前不会在发现高收益区间后做二次细分/放大搜索，可能停留在局部次优。
- 单目标优化：只按年化收益排序，未结合夏普/回撤的综合优化，可能偏向高波动格子。

## 4. 提升思路（收益挖掘优先级）
1) 增加分档与自适应细化：将自动分档改为 5–10 档或“粗网格+精网格”两阶段，对 Top-K 高收益格子再切细一倍范围。  
2) 可调样本阈值：为自动组合单独下调 `param_min_samples`（如 150/200），同时在报告显示样本量以提示风险。  
3) 多目标排序：增加夏普/回撤权重，选取综合得分最优，而非纯年化收益，减少极端波动的伪高收益。  
4) 业务分层预设：对长尾因子（市值、持股比例）增加“业务阈值”切分（如50亿/500亿/1000亿），与分位切分并行，取二者最优。  
5) 迭代缩窗：对最佳区间做“中心缩窗/扩窗”微调（±10% 边界）再评估，防止分位边界误差。  
6) 记录备选 Top-N：除最佳区间外输出 Top-5 区间，便于人工筛选潜在高收益但样本更稳健的组合。

## 5. 结论
- 当前策略能保证用户自定义区间被准确评估，高收益组合可被初步筛出，但自动部分属于“低分辨率网格+固定样本阈值”，不一定是全局最优。  
- 若目标是“最大化挖掘最高收益”且可接受更细的搜索与运行时间，建议先启用更细分档+二次细化（思路 1），并配合多目标排序（思路 3）和 Top-N 备选输出（思路 6）。  
- 若运行时长或稳定性优先，可维持现状，但需知晓可能遗漏更优窄区间。***
