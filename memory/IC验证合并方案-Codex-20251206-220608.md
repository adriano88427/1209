# IC验证合并方案（模块化 + 收尾动作）

## 目标
- 将现有 IC 验证能力（差异对比、审计、外部基准、CI/Bootstrap 等）收拢为统一入口模块，便于复用。
- 补完收尾方案中的验证缺口（外部基准、零/负价审计、核心因子置信区间、审计摘要落盘、覆盖提示）。

## 模块方案（fa_ic_validation.py 已创建）
1. 入口函数（待补）：`run_ic_validation(config, baseline_path, target_path, options)`，统一调度对比/审计/基准。
2. 功能子块：
   - 汇总对比：等权/加权 IC、样本、缺样/skip，输出差异表。
   - 审计摘要：去重、缩尾、flip、skip 原因、零/负价过滤计数，落盘单一摘要。
   - 外部基准适配：可插拔调用外部框架，对比核心因子 IC。
   - 核心因子统计：p 值、t 值、（可选）CI/Bootstrap。
3. 配置：复用 `fa_config.py`，仅新增少量验证开关（默认关闭）；模块读取最新汇总/日志路径。
4. 输出：差异表、核心因子对比、审计摘要、覆盖提示文本，统一写入 `baogao/`。

## 收尾动作（待执行）
1. 外部基准对照：同数据外部算 IC，核心因子对比，生成 `baogao/ic_benchmark_compare.csv`。
2. 零/负价审计：检测并剔除 ≤0 价格，计数写入审计摘要；运行基线确认计数。
3. 核心因子 CI/Bootstrap：输出 `baogao/ic_ci_core_factors.csv`，在汇总/报告轻量提示。
4. 审计摘要落盘：单一 `baogao/audit_summary_latest.csv`，含去重、缩尾、skip、flip、零价过滤等。
5. 覆盖提示：在汇总/报告增加年度覆盖、板块集中提示（轻量字段/文本）。

## 验证标准与回退
- 对比阈值：核心因子 |ΔIC| < 0.01 且方向一致，p 值/CI 未现明显矛盾。
- 零/负价：计数为 0 或极低且可解释，否则补充清洗或告警。
- 性能：运行时长/内存无显著回归，必要时关闭 CI/Bootstrap 或仅核心因子执行。
- 回退：保持开关粒度，随时回到基线配置（无缩尾、可拼窗）。

## 现状与待补
- 现状：`fa_ic_validation.py` 已支持差异表、核心因子对比、审计摘要解析；收尾方案已列出待办。
- 待补：实现 `run_ic_validation` 调度、外部基准适配、零价审计、CI/Bootstrap、审计摘要落盘和覆盖提示。
