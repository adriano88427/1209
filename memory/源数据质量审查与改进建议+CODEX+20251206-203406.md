# 源数据质量审查与改进建议（shuju/biaoge）

## 快速体检
- 样本量与列数：2021/2022/2023/2024/2025 五个文件，行数 3014–5711，列 57–59，核心列（股票代码、信号日期、次日开盘买入持股两日收益率、当日/次日涨跌幅）齐全。
- 缺失与唯一值：核心收益列缺失率 <0.07%，信号日期唯一值 ~180–243 天/年，代码唯一值 595–813，基础完整性可接受。
- 极值分布：收益类（两日收益率、次日开盘涨跌幅）3σ 超出占比 ~1.4%–2.1%；因子类的涨幅列 3σ 超出≈0，分布较集中，可能被限幅/离散化。
- 字段一致性：2021/2025 含 59 列（多了当日回调、次日开盘涨跌幅等列），中间年份 57 列，需在管道中做列对齐或填补默认值。
- 时序覆盖：2025 文件仅 180 个交易日，不是完整年，可能带来年度权重偏移。

## 是否符合 IC 计算数据标准
- 必要列：代码、信号日期、收益列、因子列均存在，缺失率低，满足最小要求。
- 变异性：收益列唯一值充足，但部分因子（涨幅类）离散度低、极值缺失，易导致“唯一值不足”或 IC 被压缩。
- 一致性风险：列数差异与可能的单位/百分比混用需检查（建议统一百分比列存小数）。
- 采样均衡：年度覆盖不均（2025 部分年份），如果按等权日均 IC，会使 2025 权重偏低；需在权重/分组上补偿。

## 改进建议
1) 列对齐与单位规范：建立列映射表，缺列直接标记/跳过（保留 NaN，不填默认值）；所有百分比转小数，金额统一币种；可保存“整洁格式”CSV 供主流程/人工核查。
2) 去重与校验：按【信号日期, 股票代码】去重；校验交易日与行情表一致性，零/负价仅计数（默认 off），如需剔除须开关控制并计入审计。
3) 变异性增强：为特定低唯一值/离散因子预留 winsor/clip 开关（默认关），裁剪计数落入审计；保留原值一份便于对照。
4) 年度权重透明：加权 IC 时在汇总/审计中标注日/年样本占比，提示非完整年度（如 2025 覆盖不足）。
5) 审计输出：导出年度/因子审计 CSV（NA 率、唯一值数、3σ 比例、去重前后行数、零价计数、裁剪计数），便于人工复核。

## 模拟一份“主流标准”示例表（列与格式）
```csv
股票代码,信号日期,因子A(标准化),因子B(比例小数),次日开盘买入持股两日收益率,当日收盘涨跌幅,次日开盘涨跌幅
300001,2024-05-06,0.12,0.083,-0.0135,0.0210,-0.0075
300002,2024-05-06,-0.34,0.156,0.0089,-0.0040,0.0121
```
要求：信号日期为交易日，代码无重复；因子已标准化或注明单位，百分比用小数；收益列为真实未限幅值，同时可附一列 winsor 后值供稳健性分析。
