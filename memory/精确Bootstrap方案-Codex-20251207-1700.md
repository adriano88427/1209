# 精确Bootstrap方案-Codex-20251207-1700

目标
- 基于日度 IC 明细进行更精确的 Bootstrap 置信区间估计，作为主流程 CI 的独立验证，不改主流程逻辑。

前置依赖
- 需已有日度 IC 明细（来自 4A 自校验或外部基准）：因子、日期、IC、样本数、权重（样本数）。
- pandas/numpy 即可；可选并行库（非必需）。

输入
- `baogao/ic_daily_check.csv`（或外部基准的日度 IC 序列）。
- 可选：因子列表、迭代次数、随机种子。

输出
- `baogao/ic_bootstrap_ci.csv`：包含因子、样本数、等权/加权 IC 均值、Bootstrap 置信区间（如 95%）、对照主流程 CI 的差异。

实现步骤
1) 读取日度 IC 明细，过滤非法值；记录日度样本数。  
2) 等权/加权均值：按日 IC 序列计算。  
3) Bootstrap：  
   - 设定迭代（如 5000）与种子；可对等权和加权分别重采样。  
   - 等权：对日 IC 序列做有放回重采样，计算均值分布。  
   - 加权：可按样本数作为概率权重进行重采样（或对加权均值做近似，如必要）。  
   - 取分位数（2.5%、97.5%）为 CI。  
4) 对比：与主流程 CI（若有）或正态近似 CI 对比，输出差异列。  
5) 落盘：`baogao/ic_bootstrap_ci.csv`，不覆盖现有文件。

参数建议
- 迭代：5000（可调）；种子固定以复现。  
- 容忍差异：与主流程 CI 差异视为诊断信息，不用于自动调参。

风险与回退
- 仅新增输出，不改主流程；若耗时过长，可先小迭代试跑。  
- 若与主流程差异大，先核对日度明细、权重策略与主流程窗口/过滤逻辑。***
