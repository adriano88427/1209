# IC验证收尾方案（外部基准、零价审计、CI/Bootstrap）

## 目标
- 以最小增量补齐“主流标准”验证缺口：外部基准对照、零/负价审计、核心因子置信区间/Bootstrap，确保结论更有说服力。

## 待办与具体步骤
1) 外部基准对照（行业交叉验证）
   - 选取同样数据集，在一套公开/业界常用框架（如 open-source quantlib 或已有内部基准脚本）上计算 Spearman IC。
   - 对比指标：等权 IC、原始 IC、样本数、缺样比例、p 值；输出对照表 `baogao/ic_benchmark_compare.csv`。
   - 以 3–5 个核心因子为主（样本充足、无极端缺失），避免大范围重复计算。

2) 零/负价审计
   - 在预处理阶段增加检测：前一日/当日/后续开收盘价 ≤0 的行计数并剔除；审计打印 `[AUDIT] zero/neg price filtered: X rows`，同时将计数写入 `audit_summary`。
   - 运行一次基线配置，确认计数为 0 或可接受范围。

3) 核心因子 CI/Bootstrap
   - 为核心因子输出 IC 的置信区间（t-based 或 bootstrap），同时保留 p 值、t 统计量。
   - 生成 `baogao/ic_ci_core_factors.csv`，并在汇总/报告增加一列或一段文字提示（轻量，不生成大表）。

4) 审计摘要落盘（轻量）
   - 汇总关键审计信息到单一文件 `baogao/audit_summary_latest.csv`：去重计数、缩尾计数/范围、skip_reason_counts、raw_vs_neutral flip 统计、零/负价过滤计数。
   - 每次运行覆盖/追加一行，避免多 CSV 膨胀。

5) 覆盖提示
   - 在汇总/报告中增加轻量提示字段：年度覆盖天数、主/次板块占比，非完整年度告警（如 2025 天数不足）。

## 验证与通过标准
- 基线 vs 基准：核心因子 IC 差异在可接受范围（如 |ΔIC| < 0.01 且方向一致），p 值/CI 未出现明显矛盾。
- 零/负价：过滤计数为 0 或极小且可解释；否则需补充数据清洗或告警。
- CI/Bootstrap：核心因子 IC 的置信区间覆盖与主流实现一致；若区间跨 0，需提示不显著。
- 性能：运行时间/内存无显著回归（与当前基线对比）。

## 回退策略
- 若外部基准差异过大或性能回归，优先关闭新增统计（CI/Bootstrap）或仅对核心因子执行；保留主路径不变。
- 保持开关粒度，逐项启用、逐项验证，可随时回到基线配置（无缩尾、无单日强制）。
