Factor analysis log - 2025-12-06 02:54:57
============================================================

[INFO] Factor analysis pipeline started
[INFO] Log file: C:\Users\lenovo\Documents\yinzifenxi\1205\baogao\factor_analysis_log_20251206_025457.txt
[INFO] Data load succeeded: 21041 rows, columns 63 (parsed 5 worksheets)
[INFO] Loading data...
[INFO] Data loaded in 0.00s. Raw sample size: 21041 rows
[INFO] [VALIDATION] === Data integrity validation ===
[DEBUG][DataValidator] Starting multi-sheet validation: Expected files 5 \u4e2a, parsed\u8bca\u65ad 5 \u6761
[DEBUG][DataValidator] Aggregation finished: \u6210\u529f\u6587\u4ef6 5 \u4e2a, \u603bsamples 21041 rows, \u4f30\u7b97coverage 100.00%
[INFO] - Expected file count: 5, Successfully read: 5, coverage: 100.0%
[INFO] - \u5408\u5e76\u540e\u603bsamples: 21041 rows, \u4f30\u7b97\u7406\u8bbasamples: 21041 rows, coverage: 100.0%
[INFO] - Per-file import summary:
[INFO] - \u56de\u6d4b\u8be6\u7ec6\u6570\u636e\u7ed3\u5408\u80a1\u672canalysis: \u521b\u4e1a\u677f2025.xlsx: 4623 rows, ratio 22.0% , worksheet Sheet1(4623)
[INFO] - \u56de\u6d4b\u8be6\u7ec6\u6570\u636e\u7ed3\u5408\u80a1\u672canalysis: \u521b\u4e1a\u677f2024.xlsx: 5711 rows, ratio 27.1% , worksheet Sheet1(5711)
[INFO] - \u56de\u6d4b\u8be6\u7ec6\u6570\u636e\u7ed3\u5408\u80a1\u672canalysis: \u521b\u4e1a\u677f2023.xlsx: 3024 rows, ratio 14.4% , worksheet Sheet1(3024)
[INFO] - \u56de\u6d4b\u8be6\u7ec6\u6570\u636e\u7ed3\u5408\u80a1\u672canalysis: \u521b\u4e1a\u677f2022.xlsx: 3014 rows, ratio 14.3% , worksheet Sheet1(3014)
[INFO] - \u56de\u6d4b\u8be6\u7ec6\u6570\u636e\u7ed3\u5408\u80a1\u672canalysis: \u521b\u4e1a\u677f2021.xlsx: 4669 rows, ratio 22.2% , worksheet Sheet1(4669)
[INFO] - Covered years: 2021, 2022, 2023, 2024, 2025 (\u5171 5 \u5e74), Covered trading days 1148 \u5929
[DEBUG][DataValidator] Year coverage check: detected 5 \u4e2a\u5e74\u4efd\u8bb0\u5f55
[INFO] - \u5217\u503c\u4e00\u81f4\u6027\u68c0\u67e5
[INFO] - No column alignment rules are configured
[DEBUG][DataValidator] Column alignment check passed
[INFO] [VALIDATION] Data validation passed
[DEBUG][DataValidator] Multi-sheet validation completed: \u72b6\u6001 PASS
[INFO] === Data Preprocessing ===
[NEUTRAL][INFO] \u5f53\u65e5\u56de\u8c03 - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 10.89s, market 1.57s, industry 9.32s]
[NEUTRAL][INFO] \u673a\u6784\u6301\u80a1\u6bd4\u4f8b(%) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.50s, industry 9.50s]
[NEUTRAL][INFO] \u8d22\u52a1\u6295\u8d44\u673a\u6784\u5408\u8ba1(\u6295\u8d44\u516c\u53f8+\u79c1\u52df+\u96c6\u5408\u7406\u8d22+\u5176\u4ed6\u7406\u8d22+\u5458\u5de5\u6301\u80a1+\u4fe1\u6258+QFII+\u5238\u5546+\u57fa\u91d1) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.29s, industry 9.29s]
[NEUTRAL][INFO] \u670b\u53cb\u5408\u8ba1(\u4f01\u4e1a\u5927\u80a1\u4e1c(\u5927\u975e)+\u793e\u4fdd+\u4fdd\u9669) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.40s, industry 9.39s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u4e2a\u4eba\u6301\u80a1\u5408\u8ba1 - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.69s, industry 9.69s]
[NEUTRAL][INFO] \u9ad8\u7ba1/\u5927\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5927\u975e - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.42s, industry 9.41s]
[NEUTRAL][INFO] \u666e\u901a\u6563\u6237\u6301\u80a1\u6bd4\u4f8b - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.46s, industry 9.45s]
[NEUTRAL][INFO] \u4f01\u4e1a\u5927\u80a1\u4e1c\u5927\u975e(\u5305\u542b\u56fd\u8d44) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.25s, industry 9.25s]
[NEUTRAL][INFO] \u4f01\u4e1a\u5927\u80a1\u4e1c(\u5305\u542b\u56fd\u8d44)(\u5c0f\u975e) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.18s, industry 9.18s]
[NEUTRAL][INFO] \u524d10\u5927\u6d41\u901a\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5408\u8ba1 - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.29s, industry 9.29s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5c0f\u975e\u5408\u8ba1 - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.24s, industry 9.24s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5927\u975e\u5408\u8ba1 - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.70s, industry 9.70s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u673a\u6784\u5927\u975e - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.67s, industry 9.67s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u673a\u6784\u5c0f\u975e - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.50s, industry 9.50s]
[NEUTRAL][INFO] \u57fa\u91d1\u6301\u4ed3ratio - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 10.78s, market 1.47s, industry 9.31s]
[NEUTRAL][INFO] QFII\u6301\u4ed3ratio - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 10.68s, market 1.46s, industry 9.22s]
[NEUTRAL][INFO] \u6301\u6709\u57fa\u91d1\u5bb6\u6570 - mode market_cap, coverage 100.0% (market rows: 21033, industry rows: 0) [total 1.46s, market 1.46s]
[NEUTRAL][INFO] \u5f53\u65e5\u6700\u9ad8\u6da8\u5e45 - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 10.72s, market 1.47s, industry 9.25s]
[NEUTRAL][INFO] \u6b21\u65e5\u5f00\u76d8\u6da8\u8dcc\u5e45 - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 10.80s, market 1.47s, industry 9.33s]
[NEUTRAL][INFO] neutralized 19 factors in 177.95s (signal groups: 1148)
[INFO] Data preprocessing complete: usable samples 21036 rows, factors 20 \u4e2a
[INFO] Data preprocessing complete in 178.85s. Remaining samples: 21036 rows
[INFO] Sample coverage validation complete in 0.19s.
[INFO] === Factor Analysis Options ===
[INFO] Available factors:
[INFO] Running full factor analysis...
[NEUTRAL][INFO] \u5f53\u65e5\u56de\u8c03 - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 11.05s, market 1.51s, industry 9.54s]
[NEUTRAL][INFO] \u673a\u6784\u6301\u80a1\u6bd4\u4f8b(%) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 10.32s, industry 10.32s]
[NEUTRAL][INFO] \u8d22\u52a1\u6295\u8d44\u673a\u6784\u5408\u8ba1(\u6295\u8d44\u516c\u53f8+\u79c1\u52df+\u96c6\u5408\u7406\u8d22+\u5176\u4ed6\u7406\u8d22+\u5458\u5de5\u6301\u80a1+\u4fe1\u6258+QFII+\u5238\u5546+\u57fa\u91d1) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 10.54s, industry 10.54s]
[NEUTRAL][INFO] \u670b\u53cb\u5408\u8ba1(\u4f01\u4e1a\u5927\u80a1\u4e1c(\u5927\u975e)+\u793e\u4fdd+\u4fdd\u9669) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 10.01s, industry 10.01s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u4e2a\u4eba\u6301\u80a1\u5408\u8ba1 - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 10.50s, industry 10.50s]
[NEUTRAL][INFO] \u9ad8\u7ba1/\u5927\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5927\u975e - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 10.36s, industry 10.36s]
[NEUTRAL][INFO] \u666e\u901a\u6563\u6237\u6301\u80a1\u6bd4\u4f8b - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.79s, industry 9.79s]
[NEUTRAL][INFO] \u4f01\u4e1a\u5927\u80a1\u4e1c\u5927\u975e(\u5305\u542b\u56fd\u8d44) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.77s, industry 9.77s]
[NEUTRAL][INFO] \u4f01\u4e1a\u5927\u80a1\u4e1c(\u5305\u542b\u56fd\u8d44)(\u5c0f\u975e) - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.88s, industry 9.88s]
[NEUTRAL][ERROR] factor \u524d10\u5927\u6d41\u901a\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5408\u8ba1 neutralization failed: [Errno 22] Invalid argument
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5c0f\u975e\u5408\u8ba1 - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.59s, industry 9.59s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5927\u975e\u5408\u8ba1 - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.43s, industry 9.43s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u673a\u6784\u5927\u975e - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.85s, industry 9.85s]
[NEUTRAL][INFO] \u5341\u5927\u6d41\u901a\u673a\u6784\u5c0f\u975e - mode industry, coverage 100.0% (market rows: 0, industry rows: 21037) [total 9.77s, industry 9.77s]
[NEUTRAL][INFO] \u57fa\u91d1\u6301\u4ed3ratio - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 11.52s, market 1.62s, industry 9.90s]
[NEUTRAL][INFO] QFII\u6301\u4ed3ratio - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 11.86s, market 1.56s, industry 10.30s]
[NEUTRAL][INFO] \u6301\u6709\u57fa\u91d1\u5bb6\u6570 - mode market_cap, coverage 100.0% (market rows: 21033, industry rows: 0) [total 1.54s, market 1.54s]
[NEUTRAL][INFO] \u5f53\u65e5\u6700\u9ad8\u6da8\u5e45 - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 11.30s, market 1.54s, industry 9.76s]
[NEUTRAL][INFO] \u6b21\u65e5\u5f00\u76d8\u6da8\u8dcc\u5e45 - mode both, coverage 100.0% (market rows: 21033, industry rows: 21033) [total 12.19s, market 1.54s, industry 10.65s]
[NEUTRAL][INFO] neutralized 19 factors in 188.89s (signal groups: 1148)
[INFO] Data preprocessing complete: usable samples 21036 rows, factors 20 \u4e2a
[ERROR] Encountered an exception during factor analysis: [Errno 22] Invalid argument
[INFO] Factor analysis stage ended in 190.88s.
[INFO] Running 10-bucket grouped analysis for every factor...
[STEP] Analyzing factor: \u5f53\u65e5\u56de\u8c03
[ERROR] Failed to analyze factor '\u5f53\u65e5\u56de\u8c03': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u673a\u6784\u6301\u80a1\u6bd4\u4f8b(%)
[ERROR] Failed to analyze factor '\u673a\u6784\u6301\u80a1\u6bd4\u4f8b(%)': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u6d41\u901a\u5e02\u503c(\u5143)
[ERROR] Failed to analyze factor '\u6d41\u901a\u5e02\u503c(\u5143)': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u8d22\u52a1\u6295\u8d44\u673a\u6784\u5408\u8ba1(\u6295\u8d44\u516c\u53f8+\u79c1\u52df+\u96c6\u5408\u7406\u8d22+\u5176\u4ed6\u7406\u8d22+\u5458\u5de5\u6301\u80a1+\u4fe1\u6258+QFII+\u5238\u5546+\u57fa\u91d1)
[ERROR] Failed to analyze factor '\u8d22\u52a1\u6295\u8d44\u673a\u6784\u5408\u8ba1(\u6295\u8d44\u516c\u53f8+\u79c1\u52df+\u96c6\u5408\u7406\u8d22+\u5176\u4ed6\u7406\u8d22+\u5458\u5de5\u6301\u80a1+\u4fe1\u6258+QFII+\u5238\u5546+\u57fa\u91d1)': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u670b\u53cb\u5408\u8ba1(\u4f01\u4e1a\u5927\u80a1\u4e1c(\u5927\u975e)+\u793e\u4fdd+\u4fdd\u9669)
[ERROR] Failed to analyze factor '\u670b\u53cb\u5408\u8ba1(\u4f01\u4e1a\u5927\u80a1\u4e1c(\u5927\u975e)+\u793e\u4fdd+\u4fdd\u9669)': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u5341\u5927\u6d41\u901a\u4e2a\u4eba\u6301\u80a1\u5408\u8ba1
[ERROR] Failed to analyze factor '\u5341\u5927\u6d41\u901a\u4e2a\u4eba\u6301\u80a1\u5408\u8ba1': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u9ad8\u7ba1/\u5927\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5927\u975e
[ERROR] Failed to analyze factor '\u9ad8\u7ba1/\u5927\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5927\u975e': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u666e\u901a\u6563\u6237\u6301\u80a1\u6bd4\u4f8b
[ERROR] Failed to analyze factor '\u666e\u901a\u6563\u6237\u6301\u80a1\u6bd4\u4f8b': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u4f01\u4e1a\u5927\u80a1\u4e1c\u5927\u975e(\u5305\u542b\u56fd\u8d44)
[ERROR] Failed to analyze factor '\u4f01\u4e1a\u5927\u80a1\u4e1c\u5927\u975e(\u5305\u542b\u56fd\u8d44)': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u4f01\u4e1a\u5927\u80a1\u4e1c(\u5305\u542b\u56fd\u8d44)(\u5c0f\u975e)
[ERROR] Failed to analyze factor '\u4f01\u4e1a\u5927\u80a1\u4e1c(\u5305\u542b\u56fd\u8d44)(\u5c0f\u975e)': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u524d10\u5927\u6d41\u901a\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5408\u8ba1
[ERROR] Failed to analyze factor '\u524d10\u5927\u6d41\u901a\u80a1\u4e1c\u6301\u80a1\u6bd4\u4f8b\u5408\u8ba1': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5c0f\u975e\u5408\u8ba1
[ERROR] Failed to analyze factor '\u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5c0f\u975e\u5408\u8ba1': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5927\u975e\u5408\u8ba1
[ERROR] Failed to analyze factor '\u5341\u5927\u6d41\u901a\u80a1\u4e1c\u5927\u975e\u5408\u8ba1': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u5341\u5927\u6d41\u901a\u673a\u6784\u5927\u975e
[ERROR] Failed to analyze factor '\u5341\u5927\u6d41\u901a\u673a\u6784\u5927\u975e': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u5341\u5927\u6d41\u901a\u673a\u6784\u5c0f\u975e
[ERROR] Failed to analyze factor '\u5341\u5927\u6d41\u901a\u673a\u6784\u5c0f\u975e': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u57fa\u91d1\u6301\u4ed3ratio
[ERROR] Failed to analyze factor '\u57fa\u91d1\u6301\u4ed3ratio': [Errno 22] Invalid argument
[STEP] Analyzing factor: QFII\u6301\u4ed3ratio
[ERROR] Failed to analyze factor 'QFII\u6301\u4ed3ratio': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u6301\u6709\u57fa\u91d1\u5bb6\u6570
[ERROR] Failed to analyze factor '\u6301\u6709\u57fa\u91d1\u5bb6\u6570': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u5f53\u65e5\u6700\u9ad8\u6da8\u5e45
[ERROR] Failed to analyze factor '\u5f53\u65e5\u6700\u9ad8\u6da8\u5e45': [Errno 22] Invalid argument
[STEP] Analyzing factor: \u6b21\u65e5\u5f00\u76d8\u6da8\u8dcc\u5e45
[ERROR] Failed to analyze factor '\u6b21\u65e5\u5f00\u76d8\u6da8\u8dcc\u5e45': [Errno 22] Invalid argument
[INFO] Grouped factor walkthrough completed in 26.82s.
[INFO] === Factor analysis results saved ===
[INFO] Generating parameterized factor summary report...
[INFO] === ??????? ===
[INFO] \u5df2generated\u5e26\u9ad8\u4eae\u7684Excel: C:\Users\lenovo\Documents\yinzifenxi\1205\baogao\\u5e26\u53c2\u6570factoranalysis\u6570\u636e_20251206_030151.xlsx
[OK] Parameterized factor HTML report generated: C:\Users\lenovo\Documents\yinzifenxi\1205\baogao\\u5e26\u53c2\u6570factor\u7efc\u5408analysisreport_20251206_030151.html
[INFO] Parameterized factor stage finished in 7.09s.
[INFO] === Dual-factor non-parametric analysis ===
[INFO][DUAL-NONPARAM] Workflow stopped after 0.00s due to empty factor pairs.
[INFO] === Dual-factor parametric analysis ===
[ERROR] Dual-factor parametric analysis failed: [Errno 22] Invalid argument
[INFO] Factor analysis program completed
[INFO] Total runtime: 415.58s


Log recording finished - 2025-12-06 03:01:52
============================================================
